{# Reusable Jinja macros for template DRY-ness #}

{#
  Renders a story item with consistent styling.

  Args:
    story: Story object with title, primary_link, published_at, links, etc.
    show_entities: Whether to display entity tags (default: false)
    show_arxiv: Whether to display arXiv ID (default: false)
#}
{% macro story_item(story, show_entities=false, show_arxiv=false) %}
<li class="story-item">
    <div class="story-title">
        <a href="{{ story.primary_link.url }}">{{ story.title }}</a>
    </div>
    <div class="story-meta">
        {% if story.published_at %}
            <span>{{ story.published_at.strftime('%Y-%m-%d') }}</span>
        {% else %}
            <span class="date-unknown">Date unknown</span>
        {% endif %}
        {% if show_entities and story.entities %}
            <span class="separator">|</span>
            <span>{{ story.entities | join(', ') }}</span>
        {% endif %}
        {% if show_arxiv and story.arxiv_id %}
            <span class="separator">|</span>
            <span>arXiv:{{ story.arxiv_id }}</span>
        {% endif %}
    </div>
    {% if story.links | length > 1 %}
    <div class="story-links">
        {% for link in story.links %}
        <a href="{{ link.url }}" title="{{ link.link_type.value }}">{{ link.link_type.value }}</a>
        {% endfor %}
    </div>
    {% endif %}
</li>
{% endmacro %}

{#
  Renders a formatted date with consistent styling.

  Args:
    date: datetime object or None
    format: strftime format string (default: '%Y-%m-%d')
#}
{% macro format_date(date, format='%Y-%m-%d') %}
{% if date %}
<span>{{ date.strftime(format) }}</span>
{% else %}
<span class="date-unknown">Date unknown</span>
{% endif %}
{% endmacro %}

{#
  Renders a section with stories.

  Args:
    title: Section heading text
    stories: List of story objects
    show_entities: Whether to show entity tags
    show_arxiv: Whether to show arXiv IDs
    ordered: Whether to use ordered list (default: false)
#}
{% macro story_section(title, stories, show_entities=false, show_arxiv=false, ordered=false) %}
{% if stories %}
<section>
    <h2>{{ title }}</h2>
    {% if ordered %}
    <ol class="story-list">
    {% else %}
    <ul class="story-list">
    {% endif %}
        {% for story in stories %}
        {{ story_item(story, show_entities=show_entities, show_arxiv=show_arxiv) }}
        {% endfor %}
    {% if ordered %}
    </ol>
    {% else %}
    </ul>
    {% endif %}
</section>
{% endif %}
{% endmacro %}
