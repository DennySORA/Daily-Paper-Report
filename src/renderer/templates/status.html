{% extends "base.html" %}

{% block title %}Daily Paper Report - Status{% endblock %}

{% block content %}
<style>
    /* Stats cards grid */
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: var(--space-4);
        margin-bottom: var(--space-8);
    }

    .stat-card {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: var(--space-5) var(--space-4);
        background: var(--color-bg-elevated);
        border: 1px solid var(--color-border-light);
        border-radius: var(--radius-xl);
        text-align: center;
        transition: all var(--duration-base) var(--ease-out);
    }

    .stat-card:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-md);
    }

    .stat-card--success { border-left: 3px solid var(--color-success); }
    .stat-card--info { border-left: 3px solid var(--color-info); }
    .stat-card--warning { border-left: 3px solid var(--color-warning); }
    .stat-card--error { border-left: 3px solid var(--color-error); }

    .stat-value {
        font-size: 2rem;
        font-weight: 700;
        line-height: 1.2;
        color: var(--color-text);
    }

    .stat-card--success .stat-value { color: var(--color-success); }
    .stat-card--info .stat-value { color: var(--color-info); }
    .stat-card--warning .stat-value { color: var(--color-warning); }
    .stat-card--error .stat-value { color: var(--color-error); }

    .stat-label {
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        color: var(--color-text-muted);
        margin-top: var(--space-2);
    }

    /* Run info card */
    .run-info-card {
        background: var(--color-bg-elevated);
        border: 1px solid var(--color-border-light);
        border-radius: var(--radius-xl);
        padding: var(--space-5);
        margin-bottom: var(--space-6);
    }

    .run-info-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: var(--space-4);
    }

    .run-info-item {
        display: flex;
        flex-direction: column;
        gap: var(--space-1);
    }

    .run-info-label {
        font-size: 0.6875rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        color: var(--color-text-muted);
    }

    .run-info-value {
        font-size: 0.875rem;
        color: var(--color-text);
    }

    .run-info-value code {
        font-family: var(--font-mono);
        font-size: 0.8125rem;
        padding: var(--space-1) var(--space-2);
        background: var(--color-bg-subtle);
        border-radius: var(--radius-sm);
        color: var(--color-text-muted);
    }

    @media (max-width: 768px) {
        .stats-grid {
            grid-template-columns: repeat(2, 1fr);
        }
    }
</style>

<div class="page-header">
    <h1>Run Status</h1>
    <p class="page-meta">Pipeline execution history and statistics.</p>
</div>

{% if recent_runs %}
<section>
    <h2>
        <span class="section-icon">ðŸ“Š</span>
        Recent Runs
    </h2>
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>Run ID</th>
                    <th>Started</th>
                    <th>Finished</th>
                    <th>Status</th>
                    <th>Items</th>
                    <th>Stories</th>
                </tr>
            </thead>
            <tbody>
                {% for run in recent_runs %}
                <tr>
                    <td><code>{{ run.run_id[:12] }}...</code></td>
                    <td>{{ run.started_at.strftime('%Y-%m-%d %H:%M') }}</td>
                    <td>
                        {% if run.finished_at %}
                            {{ run.finished_at.strftime('%Y-%m-%d %H:%M') }}
                        {% else %}
                            <em>In progress</em>
                        {% endif %}
                    </td>
                    <td>
                        {% if run.success is none %}
                            <span class="status-badge status-warning">Running</span>
                        {% elif run.success %}
                            <span class="status-badge status-success">Success</span>
                        {% else %}
                            <span class="status-badge status-error">Failed</span>
                        {% endif %}
                    </td>
                    <td>{{ run.items_total }}</td>
                    <td>{{ run.stories_total }}</td>
                </tr>
                {% if run.error_summary and not run.success %}
                <tr>
                    <td colspan="6" style="padding-left: var(--space-8); font-size: 0.8125rem; color: var(--color-error);">
                        <strong>Error:</strong> {{ run.error_summary }}
                    </td>
                </tr>
                {% endif %}
                {% endfor %}
            </tbody>
        </table>
    </div>
</section>
{% else %}
<div class="empty-state">
    <div class="empty-state-icon">ðŸ“­</div>
    <p>No run history available.</p>
</div>
{% endif %}
{% endblock %}
